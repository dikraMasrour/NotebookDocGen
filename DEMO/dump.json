{"cells": [{"cell_type": "markdown", "metadata": {}, "source": ["## Training word2vec model for moroccan and algerian dialect"]}, {"cell_type": "markdown", "metadata": {}, "source": ["##### Imports"]}, {"cell_type": "code", "execution_count": 1, "metadata": {}, "outputs": [], "source": ["import gensim\n", "import pandas as pd\n", "import nltk\n", "import glob"]}, {"cell_type": "code", "execution_count": 26, "metadata": {}, "outputs": [{"data": {"text/html": ["<div>\n", "<style scoped>\n", "    .dataframe tbody tr th:only-of-type {\n", "        vertical-align: middle;\n", "    }\n", "\n", "    .dataframe tbody tr th {\n", "        vertical-align: top;\n", "    }\n", "\n", "    .dataframe thead th {\n", "        text-align: right;\n", "    }\n", "</style>\n", "<table border=\"1\" class=\"dataframe\">\n", "  <thead>\n", "    <tr style=\"text-align: right;\">\n", "      <th></th>\n", "      <th>comments</th>\n", "    </tr>\n", "  </thead>\n", "  <tbody>\n", "    <tr>\n", "      <th>0</th>\n", "      <td>\u0639\u0627\u062f\u0648 \u0627\u0644\u0646\u0627\u0633 \u064a\u062a\u0628\u0627\u0643\u0627\u0648 \u0628\u062f\u064a\u062a \u0646\u0647\u062f\u0631 \u0645\u0646 \u0642\u0644\u0628\u064a \u062a\u0642\u0648\u0644 \u0646\u0647\u062f...</td>\n", "    </tr>\n", "    <tr>\n", "      <th>1</th>\n", "      <td>\u0628\u0643\u064a\u062a \u0627\u0644\u0646\u0627\u0633 \u0643\u0627\u0645\u0644 \u0633\u0643\u062a\u0648 \u062a\u062e\u0644\u0639\u062a \u0641\u064a \u0631\u0648\u062d\u064a \u062a\u0642\u0648\u0644 \u0643\u0646\u062a \u0646\u0646\u0648\u0645</td>\n", "    </tr>\n", "    <tr>\n", "      <th>2</th>\n", "      <td>\u0646\u0627\u0636\u0648 \ufb6d\ufe8e\u0639 \u0633\u0644\u0645\u0648 \u0639\u0644\u064a\u0627 \u0648 \u064a\u0647\u062f\u0631\u0648 \u0645\u0639\u0627\u064a\u0627 \u0646\u0635 \u0628\u0643\u0627 \u0648 \u0646\u0635 \u0644...</td>\n", "    </tr>\n", "    <tr>\n", "      <th>3</th>\n", "      <td>\u0639\u0631\u0636\u0648\u0646\u0627 \u0644\u0644\u0639\u0634\u0627 \u0648 \u0643\u0627\u0646 \u0644\u0639\u0634\u0627 \u064a\u0643\u0641\u064a \u0644\u064a\u0632\u0627\ufee7\u06a2\u064a\u062a\u064a \ufb6d\ufe8e\u0639</td>\n", "    </tr>\n", "    <tr>\n", "      <th>4</th>\n", "      <td>\u062c\u0648\u0632\u062a \u0627\u064a\u0627\u0645\u0627\u062a \u0631\u0648\u0639\u0629 \u0645\u0627 \u0646\u0646\u0633\u0627\u0647\u0627\u0634 \u0637\u0648\u0644 \u062d\u064a\u0627\u062a\u064a</td>\n", "    </tr>\n", "  </tbody>\n", "</table>\n", "</div>"], "text/plain": ["                                            comments\n", "0   \u0639\u0627\u062f\u0648 \u0627\u0644\u0646\u0627\u0633 \u064a\u062a\u0628\u0627\u0643\u0627\u0648 \u0628\u062f\u064a\u062a \u0646\u0647\u062f\u0631 \u0645\u0646 \u0642\u0644\u0628\u064a \u062a\u0642\u0648\u0644 \u0646\u0647\u062f...\n", "1   \u0628\u0643\u064a\u062a \u0627\u0644\u0646\u0627\u0633 \u0643\u0627\u0645\u0644 \u0633\u0643\u062a\u0648 \u062a\u062e\u0644\u0639\u062a \u0641\u064a \u0631\u0648\u062d\u064a \u062a\u0642\u0648\u0644 \u0643\u0646\u062a \u0646\u0646\u0648\u0645\n", "2  \u0646\u0627\u0636\u0648 \ufb6d\ufe8e\u0639 \u0633\u0644\u0645\u0648 \u0639\u0644\u064a\u0627 \u0648 \u064a\u0647\u062f\u0631\u0648 \u0645\u0639\u0627\u064a\u0627 \u0646\u0635 \u0628\u0643\u0627 \u0648 \u0646\u0635 \u0644...\n", "3         \u0639\u0631\u0636\u0648\u0646\u0627 \u0644\u0644\u0639\u0634\u0627 \u0648 \u0643\u0627\u0646 \u0644\u0639\u0634\u0627 \u064a\u0643\u0641\u064a \u0644\u064a\u0632\u0627\ufee7\u06a2\u064a\u062a\u064a \ufb6d\ufe8e\u0639\n", "4              \u062c\u0648\u0632\u062a \u0627\u064a\u0627\u0645\u0627\u062a \u0631\u0648\u0639\u0629 \u0645\u0627 \u0646\u0646\u0633\u0627\u0647\u0627\u0634 \u0637\u0648\u0644 \u062d\u064a\u0627\u062a\u064a"]}, "execution_count": 26, "metadata": {}, "output_type": "execute_result"}], "source": ["path = r'C:\\\\Users\\\\zbook\\\\OneDrive - UIR\\\\UIR\\\\S8\\\\AutoTranslate\\\\word2vec_trainingdata'\n", "all_files = glob.glob(path + \"/*.csv\")\n", "\n", "li = []\n", "\n", "for filename in all_files:\n", "    df_elem = pd.read_csv(filename, index_col=None, header=0, on_bad_lines='skip')\n", "    li.append(df_elem)\n", "\n", "df = pd.concat(li, ignore_index=True)\n", "df.head()"]}, {"cell_type": "code", "execution_count": 27, "metadata": {}, "outputs": [{"data": {"text/plain": ["(115226, 1)"]}, "execution_count": 27, "metadata": {}, "output_type": "execute_result"}], "source": ["df.shape"]}, {"cell_type": "markdown", "metadata": {}, "source": ["##### Tokenizing"]}, {"cell_type": "code", "execution_count": 28, "metadata": {}, "outputs": [{"data": {"text/plain": ["0         [\u0639\u0627\u062f\u0648, \u0627\u0644\u0646\u0627\u0633, \u064a\u062a\u0628\u0627\u0643\u0627\u0648, \u0628\u062f\u064a\u062a, \u0646\u0647\u062f\u0631, \u0645\u0646, \u0642\u0644\u0628\u064a, \u062a...\n", "1         [\u0628\u0643\u064a\u062a, \u0627\u0644\u0646\u0627\u0633, \u0643\u0627\u0645\u0644, \u0633\u0643\u062a\u0648, \u062a\u062e\u0644\u0639\u062a, \u0641\u064a, \u0631\u0648\u062d\u064a, \u062a\u0642\u0648...\n", "2         [\u0646\u0627\u0636\u0648, \ufb6d\ufe8e\u0639, \u0633\u0644\u0645\u0648, \u0639\u0644\u064a\u0627, \u0648, \u064a\u0647\u062f\u0631\u0648, \u0645\u0639\u0627\u064a\u0627, \u0646\u0635, \u0628...\n", "3         [\u0639\u0631\u0636\u0648\u0646\u0627, \u0644\u0644\u0639\u0634\u0627, \u0648, \u0643\u0627\u0646, \u0644\u0639\u0634\u0627, \u064a\u0643\u0641\u064a, \u0644\u064a\u0632\u0627\ufee7\u06a2\u064a\u062a\u064a,...\n", "4             [\u062c\u0648\u0632\u062a, \u0627\u064a\u0627\u0645\u0627\u062a, \u0631\u0648\u0639\u0629, \u0645\u0627, \u0646\u0646\u0633\u0627\u0647\u0627\u0634, \u0637\u0648\u0644, \u062d\u064a\u0627\u062a\u064a]\n", "                                ...                        \n", "115221    [\u0634\u0643\u0631\u0627, \u0644\u0642\u062f, \u0627\u0633\u062a\u0645\u062a\u0639\u062a, \u0628\u0647\u0630\u0627, \u0627\u0644\u0641\u064a\u062f\u064a\u0648, \u0643\u062b\u064a\u0631\u0627, \u062e\u0628\u064a...\n", "115222    [\u0641\u064a\u062f\u064a\u0648, \u0645\u0645\u062a\u0639, \u0648\u0627\u0644\u0644\u0647, \u0631\u0648\u0648\u0648\u0639\u0629, \u064a\u0639\u0637\u064a\u0643, \u0627\u0644\u0635\u062d\u0629, \u062e\u0648\u064a...\n", "115223            [\u0628\u0631\u0627\u0627\u0627\u0641\u0648, \u0639\u0644\u064a\u0643, \u062a\u0633\u062a\u0627\u0647\u0644, \u0627\u0644\u0634\u0647\u0631\u0629, \u0627\u0644\u0639\u0627\u0644\u0645\u064a\u0629]\n", "115224    [\u0627\u0644\u0644\u0647, \u064a\u0628\u0627\u0631\u0643, \u060c, \u0645\u0627, \u0634\u0627\u0621, \u0627\u0644\u0644\u0647, \u062e\u0648\u064a\u0627, \u062e\u0628\u064a\u0628\u064a\u0633\u0651\u0631...\n", "115225                     [\u0623\u0641\u0636\u0644, \u0635\u0627\u0646\u0639, \u0645\u062d\u062a\u0648\u0649, \u0641\u064a, \u0627\u0644\u062c\u0632\u0627\u0626\u0631]\n", "Name: comments, Length: 115226, dtype: object"]}, "execution_count": 28, "metadata": {}, "output_type": "execute_result"}], "source": ["df_tokenized = df.comments.apply(nltk.word_tokenize)\n", "df_tokenized"]}, {"cell_type": "markdown", "metadata": {}, "source": ["##### Initializing word2vec model"]}, {"cell_type": "code", "execution_count": 30, "metadata": {}, "outputs": [], "source": ["model = gensim.models.Word2Vec(window=5, min_count=2, workers=2)"]}, {"cell_type": "markdown", "metadata": {}, "source": ["##### Building vovab"]}, {"cell_type": "code", "execution_count": 31, "metadata": {}, "outputs": [], "source": ["model.build_vocab(df_tokenized, progress_per=5)"]}, {"cell_type": "code", "execution_count": 8, "metadata": {}, "outputs": [{"data": {"text/plain": ["5"]}, "execution_count": 8, "metadata": {}, "output_type": "execute_result"}], "source": ["# epochs being the number of iterations done on the whole dataset, by default it is 5\n", "model.epochs"]}, {"cell_type": "markdown", "metadata": {}, "source": ["##### Model training"]}, {"cell_type": "code", "execution_count": 32, "metadata": {}, "outputs": [{"data": {"text/plain": ["(4727130, 5645515)"]}, "execution_count": 32, "metadata": {}, "output_type": "execute_result"}], "source": ["model.train(df_tokenized, total_examples=model.corpus_count, epochs=model.epochs)"]}, {"cell_type": "markdown", "metadata": {}, "source": ["##### Saving model"]}, {"cell_type": "code", "execution_count": 33, "metadata": {}, "outputs": [], "source": ["model.save('./word2vec_mor_dz.model')"]}, {"cell_type": "markdown", "metadata": {}, "source": ["##### Testing"]}, {"cell_type": "code", "execution_count": 36, "metadata": {}, "outputs": [{"data": {"text/plain": ["array([-0.30374986,  0.07175432, -1.9774907 ,  0.8653471 ,  1.0058571 ,\n", "        0.03052483,  1.6197143 , -1.0898234 ,  1.1693029 ,  0.96499985,\n", "       -1.1037531 , -1.5497943 ,  1.9381372 ,  1.0726736 ,  0.7137537 ,\n", "       -1.9590017 , -0.7012492 , -0.37255132, -0.19502258, -0.01550069,\n", "        0.30475372,  0.02588587, -0.10248473,  0.75695884,  0.87948567,\n", "       -1.8181672 ,  0.20955311, -0.29015642,  0.6445919 , -1.2174771 ,\n", "        2.6708517 , -0.37695837,  1.6182309 , -0.16528021, -1.2222136 ,\n", "        0.04739395,  0.03246354,  1.685888  ,  0.8174039 , -1.4625372 ,\n", "       -1.1201082 ,  0.2508373 ,  1.0266021 , -0.27731118,  0.01646691,\n", "       -1.3282051 ,  0.6850137 ,  0.15229063,  0.57460415,  0.7096181 ,\n", "        0.83873975, -0.14124483, -0.05335499, -2.1376112 ,  0.7597384 ,\n", "        0.00964276,  0.32463962,  1.6149795 ,  0.25036755, -0.84656155,\n", "       -0.11048245, -0.41262317,  1.1813644 , -0.61122257, -1.9603467 ,\n", "        0.73217666, -0.12566723,  1.2469335 , -1.2762504 ,  1.3140593 ,\n", "       -0.0808326 ,  0.67132723,  1.4991429 ,  1.59795   , -0.03220373,\n", "       -0.8748432 , -0.5941907 , -0.64879906, -0.08678758,  1.7098435 ,\n", "       -0.5889559 , -0.64070845,  0.19907294,  0.086163  , -0.30998918,\n", "       -1.4234908 ,  0.7986347 , -0.69719934, -0.9008635 ,  0.01687654,\n", "       -0.3002783 ,  0.44608024,  1.938321  , -0.72941923,  0.94874084,\n", "       -0.19638109,  1.2977958 ,  0.91942734,  0.67938447, -0.65222347],\n", "      dtype=float32)"]}, "execution_count": 36, "metadata": {}, "output_type": "execute_result"}], "source": ["model.wv.get_vector('\u0627\u0644\u0641\u064a\u062f\u064a\u0648')"]}, {"cell_type": "code", "execution_count": 37, "metadata": {}, "outputs": [{"data": {"text/plain": ["100"]}, "execution_count": 37, "metadata": {}, "output_type": "execute_result"}], "source": ["model.wv.vector_size"]}, {"cell_type": "code", "execution_count": 38, "metadata": {}, "outputs": [{"data": {"text/plain": ["[('\u0627\u0644\u0641\u062f\u064a\u0648', 0.8424222469329834),\n", " ('\u0627\u0644\u0641\u064a\u062f\u064a\u0648\u0647\u0627\u062a', 0.8212994337081909),\n", " ('\u0627\u0644\u064a\u0648\u0645', 0.809577226638794),\n", " ('\u0627\u0644\u0648\u0635\u0641\u0629', 0.8092324137687683),\n", " ('\u0627\u0644\u0645\u062e\u062a\u0644\u0633\u064a\u0646', 0.7842799425125122),\n", " ('\u0644\u0641\u064a\u062f\u064a\u0648', 0.7826778888702393),\n", " ('\u0627\u0644\u0645\u0646\u0628\u0631', 0.7803176641464233),\n", " ('\u0627\u0644\u062d\u0644\u0642\u0629', 0.7770587205886841),\n", " ('\u0627\u0644\u0641\u064a\u062f\u064a\u0648\u0627', 0.7731214761734009),\n", " ('\u0627\u0644\u0627\u063a\u0646\u064a\u0629', 0.7693439722061157)]"]}, "execution_count": 38, "metadata": {}, "output_type": "execute_result"}], "source": ["model.wv.most_similar('\u0627\u0644\u0641\u064a\u062f\u064a\u0648')"]}, {"cell_type": "code", "execution_count": 39, "metadata": {}, "outputs": [{"data": {"text/plain": ["[('\u0635\u062d\u0629', 0.957695722579956),\n", " ('\u0627\u0644\u0635\u062d\u0647', 0.9494235515594482),\n", " ('\u0635\u062d\u0647', 0.9477626085281372),\n", " ('\u0627\u0627\u0635\u062d\u0629', 0.9430625438690186),\n", " ('\u0627\u0644\u0639\u0627\u0641\u064a\u0647', 0.938389778137207),\n", " ('\u0627\u0644\u0635\u062d\u0627', 0.934445858001709),\n", " ('\u0645\u0627\u062a\u062a\u0645\u0646\u0649', 0.9239757657051086),\n", " ('\u0627\u0644\u0639\u0627\u0641\u064a\u0629', 0.921890139579773),\n", " ('\u064a\u0645\u0646\u064a\u0643', 0.921332597732544),\n", " ('\u0645\u0627\u062a\u062a\u0645\u0646\u0627', 0.920365035533905)]"]}, "execution_count": 39, "metadata": {}, "output_type": "execute_result"}], "source": ["model.wv.most_similar('\u0627\u0644\u0635\u062d\u0629')"]}, {"cell_type": "code", "execution_count": 42, "metadata": {}, "outputs": [{"data": {"text/plain": ["[('\u0633\u0648\u0621', 0.8432469964027405),\n", " ('\u0634\u0631', 0.8258323669433594),\n", " ('\u0641\u062d\u064a\u0627\u062a\u0647\u0627', 0.8234294056892395),\n", " ('\u0627\u0639\u062a\u062f\u0649', 0.8075923323631287),\n", " ('\u0645\u0643\u0631\u0648\u0647', 0.8055546283721924),\n", " ('\u0648\u0634\u0639\u0628\u0646\u0627', 0.7985508441925049),\n", " ('\u0627\u0645\u0627\u0646\u064a\u0643\u0645', 0.7867958545684814),\n", " ('\u064a\u0634\u0627\u0641\u064a', 0.7866781949996948),\n", " ('\u0645\u0642\u0627\u0645\u0647\u0627', 0.7856148481369019),\n", " ('\u0627\u0644\u062e\u064a\u0631', 0.7848873138427734)]"]}, "execution_count": 42, "metadata": {}, "output_type": "execute_result"}], "source": ["model.wv.most_similar('\u062e\u064a\u0631')"]}, {"cell_type": "code", "execution_count": 46, "metadata": {}, "outputs": [{"data": {"text/plain": ["0.55149865"]}, "execution_count": 46, "metadata": {}, "output_type": "execute_result"}], "source": ["model.wv.similarity(w1='\u0627\u0644\u062e\u064a\u0631', w2='\u0635\u0628\u0627\u062d')"]}], "metadata": {"interpreter": {"hash": "7e0683708a40e5e31be6eca1343e37f88fae9f778fb3fd433a047241db249add"}, "kernelspec": {"display_name": "Python 3.8.6 64-bit", "language": "python", "name": "python3"}, "language_info": {"codemirror_mode": {"name": "ipython", "version": 3}, "file_extension": ".py", "mimetype": "text/x-python", "name": "python", "nbconvert_exporter": "python", "pygments_lexer": "ipython3", "version": "3.8.6"}}, "nbformat": 4, "nbformat_minor": 2}